
# Fix seed and figure font
set.seed(42)
theme_set(theme_gray(base_family = "Arial"))

# Execute PROGENy Analysis to the scRNA-seq data by Lengyel et al
progeny_results_len <- progeny(
                          expr = len_progeny_matrix,
                          scale = TRUE,
                          organism = "Human",
                          top = 100,
                          perm = 1,
                          verbose = TRUE,
                          assay_name = "normalized expression values"
                          )
## Number of genes used per pathway to compute progeny scores:
## Androgen: 98 (98%)
## EGFR: 93 (93%)
## Estrogen: 97 (97%)
## Hypoxia: 98 (98%)
## JAK-STAT: 98 (98%)
## MAPK: 97 (97%)
## NFkB: 100 (100%)
## p53: 93 (93%)
## PI3K: 85 (85%)
## TGFb: 96 (96%)
## TNFa: 97 (97%)
## Trail: 73 (73%)
## VEGF: 87 (87%)
## WNT: 97 (97%)

progeny_results_len_df <- as.data.frame(progeny_results_len)
epi_filter_len <- AddMetaData(epi_filter_len, metadata = progeny_results_len_df)

# Execute PROGENy Analysis to the scRNA-seq data by Ulrich et al
progeny_results_ul <- progeny(
                          expr = ul_progeny_matrix,
                          scale = TRUE,
                          organism = "Human",
                          top = 100,
                          perm = 1,
                          verbose = TRUE,
                          assay_name = "normalized expression values"
                          )
## Number of genes used per pathway to compute progeny scores:
## Androgen: 98 (98%)
## EGFR: 91 (91%)
## Estrogen: 97 (97%)
## Hypoxia: 98 (98%)
## JAK-STAT: 98 (98%)
## MAPK: 97 (97%)
## NFkB: 100 (100%)
## p53: 90 (90%)
## PI3K: 85 (85%)
## TGFb: 95 (95%)
## TNFa: 96 (96%)
## Trail: 70 (70%)
## VEGF: 74 (74%)
## WNT: 96 (96%)

progeny_results_ul_df <- as.data.frame(progeny_results_ul)
epi_filter_ul <- AddMetaData(epi_filter_ul, metadata = progeny_results_ul_df)
